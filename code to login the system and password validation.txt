#include<stdio.h>
#include<string.h>
#include<stdlib.h>
#include<conio.h>
#define USER_FILE "user.txt"
void welcome_msg(void);
void get_username(void);
void get_password(void);
void exit_message(void);
void maskPassword(char password[]);

int flag=0;
int n=0;

#define ADM "admin\0"
#define PWD "rayhaan\0"

void welcome_msg(void)
{
        system("cls");
        printf("\t\t\t\tWELCOME\n");
        printf("\t\t-------------------------------------\n\n");
        printf("\t\t      PAYROLL MANAGEMENT SYSTEM\n");
        printf("\t\t-------------------------------------\n\n");
        printf("\tSUBMITTED TO\n");
        printf("\tFaculty Name: Sivaram");
        printf("\t\t");
        printf("SUBMITTED BY: Team MARVALS\n\n");
        printf("\nPress any key to continue >>> ");
        getch();
}


void main_menu(void)
{
        system("cls");
        printf("\t\t\t\t _______________________________________________");
        printf("\n\t\t\t\t|\t\t      MENU                     |");
        printf("\n\t\t\t\t|______________________________________________|");
        printf("\n\t\t\t\t| [1] MANAGE EMPLOYEES                         |");
        printf("\n\t\t\t\t|______________________________________________|");
        printf("\n\t\t\t\t| [2] PRINT REPORT                             |");
        printf("\n\t\t\t\t|______________________________________________|");
        printf("\n\t\t\t\t| [3] PRINT SLIP                               |");
        printf("\n\t\t\t\t|______________________________________________|");
        printf("\n\t\t\t\t| [4] EXIT                                     |");
        printf("\n\t\t\t\t|______________________________________________|\n");
        printf("\n\t\t\t\tPLEASE CHOOSE A NUMBER IN THE BOX ABOVE >>> ");
}

void get_username(void)
{
        FILE *fp;
        char username[30];
        int val=0;
        system("cls");
        printf("Enter the username >>> ");
        scanf("%s",username);
        if(strcmp(username,ADM) == 0)
        {
                flag = 0;
        }
        else
        {
                fp = fopen(USER_FILE,"r");
                while(!feof(fp))
                {
                        val=strcmp(username,fp);
                        if(val == 1)
                        {
                                flag =1;
                                break;
                        }
                }
                if(flag = 0)
                        printf("Invalid username!!");
                fclose(fp);
        }
}
void maskPassword(char password[30])
{
        char ch;
        int i=0;
        while((ch =_getch())!=13)
        {
                printf("*");
                password[i]=ch;
                i++;
        }
        password[i]='\0';
}

void get_password(void)
{
        char password[30];
        do
        {
                system("cls");
                printf("Enter the password >>> ");
                maskPassword(password);
                if(strcmp(password,PWD)!=0)
                {
                    printf("\nWrong Password!!!");
                    sleep(2);
                }

        }while(strcmp(password,PWD)!=0);
}

void exit_message(void)
{
        system("cls");
        printf("THANK YOU!\n");
        //printf(">>> ");

}

int main(/*int argc,char *argv[]*/)
{
        int menuOpt;
        int isExit=0;
        welcome_msg();
        get_username();
        get_password();
        if(flag == 1)
        {
                menuOpt = 3;
                goto label;
        }
        do
        {
            main_menu();
            menuOpt = (char)getche();
            sleep(1);
            //fflush(stdin);
    label : switch(menuOpt)
                {
                        case '1':
                        {
                                //manage_employee();
                                break;
                        }
                        case '2':
                        {
                                //print_report();
                                break;
                        }
                        case '3':
                        {
                                //print_slip();
                                break;
                        }
                        case '4':
                        {
                                isExit = 1;
                                break;
                        }
                        default:
                        {
                                system("cls");
                                printf("Invalid Option!");
                                fflush(stdin);
                                sleep(5);
                                break;
                        }
                }
        }while(isExit == 0);
        exit_message();
        fflush(stdin);
        getch();
        return (0);
 }
